<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Банковские карты - Управление</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fas fa-credit-card"></i>
                <h1>Банк-Карты</h1>
            </div>
            <div class="user-menu" id="userMenu" style="display: none;">
                <span id="userFullName"></span>
                <button onclick="logout()" class="btn-logout">Выйти</button>
            </div>
        </header>

        <!-- Authentication Section -->
        <div class="auth-section" id="authSection">
            <div class="auth-tabs">
                <button class="tab-btn active" onclick="showLogin()">Войти</button>
                <button class="tab-btn" onclick="showRegister()">Регистрация</button>
            </div>

            <!-- Login Form -->
            <div class="auth-form" id="loginForm">
                <h2>Вход в систему</h2>
                <form onsubmit="login(event)">
                    <div class="form-group">
                        <label>Логин:</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="form-group">
                        <label>Пароль:</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn-primary">Войти</button>
                </form>
            </div>

            <!-- Register Form -->
            <div class="auth-form" id="registerForm" style="display: none;">
                <h2>Регистрация</h2>
                <form onsubmit="register(event)">
                    <div class="form-group">
                        <label>Логин:</label>
                        <input type="text" id="regUsername" required minlength="3">
                    </div>
                    <div class="form-group">
                        <label>Полное имя:</label>
                        <input type="text" id="regFullName" required>
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="regEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Пароль:</label>
                        <input type="password" id="regPassword" required minlength="6">
                    </div>
                    <button type="submit" class="btn-primary">Зарегистрироваться</button>
                </form>
            </div>
        </div>

        <!-- Main Application -->
        <div class="main-app" id="mainApp" style="display: none;">
            <!-- Navigation -->
            <nav class="nav-tabs">
                <button class="nav-btn active" onclick="showSection('cards')">
                    <i class="fas fa-credit-card"></i> Мои карты
                </button>
                <button class="nav-btn" onclick="showSection('transfer')">
                    <i class="fas fa-exchange-alt"></i> Переводы
                </button>
                <button class="nav-btn" onclick="showSection('transactions')">
                    <i class="fas fa-history"></i> История
                </button>
            </nav>

            <!-- Cards Section -->
            <div class="section active" id="cardsSection">
                <div class="section-header">
                    <h2>Мои банковские карты</h2>
                    <button class="btn-primary" onclick="showCreateCardForm()">
                        <i class="fas fa-plus"></i> Добавить карту
                    </button>
                </div>
                
                <div class="cards-grid" id="cardsGrid">
                    <!-- Cards will be loaded here -->
                </div>

                <!-- Create Card Form -->
                <div class="modal" id="createCardModal">
                    <div class="modal-content">
                        <h3>Создать новую карту</h3>
                        <form onsubmit="createCard(event)">
                            <div class="form-group">
                                <label>Имя держателя карты:</label>
                                <input type="text" id="cardHolderName" required>
                            </div>
                            <div class="form-group">
                                <label>Тип карты:</label>
                                <select id="cardType" required>
                                    <option value="DEBIT">Дебетовая</option>
                                    <option value="CREDIT">Кредитная</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Номер карты:</label>
                                <input type="text" id="cardNumber" placeholder="Введите 16 цифр или оставьте пустым для автогенерации" maxlength="16" pattern="[0-9]{16}" title="16 цифр">
                                <small style="color: #666; font-size: 0.85rem;">Если оставить пустым, номер будет сгенерирован автоматически</small>
                            </div>
                            <div class="form-group">
                                <label>Месяц окончания:</label>
                                <select id="cardExpiryMonth" required>
                                    <option value="01">01</option>
                                    <option value="02">02</option>
                                    <option value="03">03</option>
                                    <option value="04">04</option>
                                    <option value="05">05</option>
                                    <option value="06">06</option>
                                    <option value="07">07</option>
                                    <option value="08">08</option>
                                    <option value="09">09</option>
                                    <option value="10">10</option>
                                    <option value="11">11</option>
                                    <option value="12">12</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Год окончания:</label>
                                <select id="cardExpiryYear" required>
                                    <option value="2025">2025</option>
                                    <option value="2026">2026</option>
                                    <option value="2027">2027</option>
                                    <option value="2028">2028</option>
                                    <option value="2029">2029</option>
                                    <option value="2030">2030</option>
                                </select>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn-primary">Создать карту</button>
                                <button type="button" class="btn-secondary" onclick="hideCreateCardForm()">Отмена</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Transfer Section -->
            <div class="section" id="transferSection" style="display: none;">
                <div class="section-header">
                    <h2>Перевод между картами</h2>
                </div>
                
                <div class="transfer-form">
                    <form onsubmit="transferMoney(event)">
                        <div class="form-group">
                            <label>С карты:</label>
                            <select id="fromCard" required>
                                <!-- Cards will be loaded here -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label>На карту:</label>
                            <select id="toCard" required>
                                <!-- Cards will be loaded here -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Сумма:</label>
                            <input type="number" id="transferAmount" step="0.01" min="0.01" required>
                        </div>
                        <div class="form-group">
                            <label>Описание (необязательно):</label>
                            <textarea id="transferDescription" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-paper-plane"></i> Выполнить перевод
                        </button>
                    </form>
                </div>
            </div>

            <!-- Transactions Section -->
            <div class="section" id="transactionsSection" style="display: none;">
                <div class="section-header">
                    <h2>История транзакций</h2>
                    <button class="btn-secondary" onclick="loadTransactions()">
                        <i class="fas fa-sync"></i> Обновить
                    </button>
                </div>
                
                <div class="transactions-list" id="transactionsList">
                    <!-- Transactions will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay" style="display: none;">
            <div class="spinner"></div>
            <p>Загрузка...</p>
        </div>

        <!-- Message Toast -->
        <div class="toast" id="toast"></div>
    </div>

    <script src="app-new.js"></script>
</body>
</html>